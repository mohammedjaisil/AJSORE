{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 58, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Kadeeja/Desktop/New%20folder/src/lib/supabase.ts"],"sourcesContent":["import { createClient } from '@supabase/supabase-js';\r\n\r\nconst supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL!;\r\nconst supabaseAnonKey = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!;\r\n\r\nexport const supabase = createClient(supabaseUrl, supabaseAnonKey);\r\n\r\n// Server-side client with service role (use carefully!)\r\nexport const supabaseAdmin = createClient(\r\n    supabaseUrl,\r\n    process.env.SUPABASE_SERVICE_ROLE_KEY!,\r\n    {\r\n        auth: {\r\n            autoRefreshToken: false,\r\n            persistSession: false\r\n        }\r\n    }\r\n);\r\n"],"names":[],"mappings":";;;;;;AAAA;;AAEA,MAAM;AACN,MAAM;AAEC,MAAM,WAAW,IAAA,8LAAY,EAAC,aAAa;AAG3C,MAAM,gBAAgB,IAAA,8LAAY,EACrC,aACA,QAAQ,GAAG,CAAC,yBAAyB,EACrC;IACI,MAAM;QACF,kBAAkB;QAClB,gBAAgB;IACpB;AACJ","debugId":null}},
    {"offset": {"line": 79, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Kadeeja/Desktop/New%20folder/src/auth.ts"],"sourcesContent":["import NextAuth from \"next-auth\"\r\nimport { SupabaseAdapter } from \"@auth/supabase-adapter\"\r\nimport Credentials from \"next-auth/providers/credentials\"\r\nimport Google from \"next-auth/providers/google\"\r\nimport { z } from \"zod\"\r\nimport { supabaseAdmin } from \"./lib/supabase\"\r\nimport bcrypt from \"bcryptjs\"\r\n\r\nexport const { handlers, auth, signIn, signOut } = NextAuth({\r\n    adapter: SupabaseAdapter({\r\n        url: process.env.NEXT_PUBLIC_SUPABASE_URL!,\r\n        secret: process.env.SUPABASE_SERVICE_ROLE_KEY!,\r\n    }),\r\n    providers: [\r\n        Google,\r\n        Credentials({\r\n            credentials: {\r\n                email: { label: \"Email\", type: \"email\" },\r\n                password: { label: \"Password\", type: \"password\" },\r\n            },\r\n            authorize: async (credentials) => {\r\n                const parsedCredentials = z\r\n                    .object({ email: z.string().email(), password: z.string().min(6) })\r\n                    .safeParse(credentials)\r\n\r\n                if (parsedCredentials.success) {\r\n                    const { email, password } = parsedCredentials.data\r\n\r\n                    // 1. Fetch user from Supabase\r\n                    const { data: user } = await supabaseAdmin\r\n                        .from('users')\r\n                        .select('*')\r\n                        .eq('email', email)\r\n                        .single()\r\n\r\n                    if (user && user.password) {\r\n                        // 2. Verify password with bcrypt\r\n                        const passwordsMatch = await bcrypt.compare(password, user.password);\r\n\r\n                        if (passwordsMatch) {\r\n                            return {\r\n                                id: user.id,\r\n                                email: user.email,\r\n                                name: user.name,\r\n                                role: user.role,\r\n                                image: user.image,\r\n                            }\r\n                        }\r\n                    }\r\n                    return null;\r\n\r\n                    // 2. Demo Auto-Signup: Create user if not exists\r\n                    const { data: newUser, error: createError } = await supabaseAdmin\r\n                        .from('users')\r\n                        .insert({\r\n                            email,\r\n                            name: email.split(\"@\")[0],\r\n                            image: `https://i.pravatar.cc/150?u=${email}`,\r\n                            role: 'USER'\r\n                        })\r\n                        .select()\r\n                        .single()\r\n\r\n                    if (newUser) {\r\n                        return {\r\n                            id: newUser.id,\r\n                            email: newUser.email,\r\n                            name: newUser.name,\r\n                            role: newUser.role,\r\n                            image: newUser.image,\r\n                        }\r\n                    }\r\n                }\r\n                return null\r\n            },\r\n        }),\r\n    ],\r\n    callbacks: {\r\n        async session({ session, token }) {\r\n            if (token?.sub && session.user) {\r\n                session.user.id = token.sub;\r\n                session.user.role = token.role as \"USER\" | \"ADMIN\" | \"SUPER_ADMIN\";\r\n            }\r\n            return session\r\n        },\r\n        async jwt({ token, user }) {\r\n            if (user) {\r\n                token.sub = user.id;\r\n                if ((user as any).role) token.role = (user as any).role;\r\n            }\r\n\r\n            if (token.sub && !token.role) {\r\n                const { data } = await supabaseAdmin\r\n                    .from('users')\r\n                    .select('role')\r\n                    .eq('id', token.sub)\r\n                    .single();\r\n\r\n                if (data) {\r\n                    token.role = data.role;\r\n                }\r\n            }\r\n            return token\r\n        }\r\n    },\r\n    session: {\r\n        strategy: \"jwt\", // Credentials provider requires JWT strategy usually\r\n    },\r\n    pages: {\r\n        signIn: \"/login\",\r\n    }\r\n})\r\n"],"names":[],"mappings":";;;;;;;;;;AAAA;AACA;AACA;AAAA;AACA;AAAA;AACA;AACA;AACA;;;;;;;;AAEO,MAAM,EAAE,QAAQ,EAAE,IAAI,EAAE,MAAM,EAAE,OAAO,EAAE,GAAG,IAAA,gKAAQ,EAAC;IACxD,SAAS,IAAA,yKAAe,EAAC;QACrB,GAAG;QACH,QAAQ,QAAQ,GAAG,CAAC,yBAAyB;IACjD;IACA,WAAW;QACP,gMAAM;QACN,IAAA,qMAAW,EAAC;YACR,aAAa;gBACT,OAAO;oBAAE,OAAO;oBAAS,MAAM;gBAAQ;gBACvC,UAAU;oBAAE,OAAO;oBAAY,MAAM;gBAAW;YACpD;YACA,WAAW,OAAO;gBACd,MAAM,oBAAoB,uKAAC,CACtB,MAAM,CAAC;oBAAE,OAAO,uKAAC,CAAC,MAAM,GAAG,KAAK;oBAAI,UAAU,uKAAC,CAAC,MAAM,GAAG,GAAG,CAAC;gBAAG,GAChE,SAAS,CAAC;gBAEf,IAAI,kBAAkB,OAAO,EAAE;oBAC3B,MAAM,EAAE,KAAK,EAAE,QAAQ,EAAE,GAAG,kBAAkB,IAAI;oBAElD,8BAA8B;oBAC9B,MAAM,EAAE,MAAM,IAAI,EAAE,GAAG,MAAM,uIAAa,CACrC,IAAI,CAAC,SACL,MAAM,CAAC,KACP,EAAE,CAAC,SAAS,OACZ,MAAM;oBAEX,IAAI,QAAQ,KAAK,QAAQ,EAAE;wBACvB,iCAAiC;wBACjC,MAAM,iBAAiB,MAAM,4IAAM,CAAC,OAAO,CAAC,UAAU,KAAK,QAAQ;wBAEnE,IAAI,gBAAgB;4BAChB,OAAO;gCACH,IAAI,KAAK,EAAE;gCACX,OAAO,KAAK,KAAK;gCACjB,MAAM,KAAK,IAAI;gCACf,MAAM,KAAK,IAAI;gCACf,OAAO,KAAK,KAAK;4BACrB;wBACJ;oBACJ;oBACA,OAAO;;;oBAEP,iDAAiD;oBACjD,MAAc,qBAAgB;gBAoBlC;gBACA,OAAO;YACX;QACJ;KACH;IACD,WAAW;QACP,MAAM,SAAQ,EAAE,OAAO,EAAE,KAAK,EAAE;YAC5B,IAAI,OAAO,OAAO,QAAQ,IAAI,EAAE;gBAC5B,QAAQ,IAAI,CAAC,EAAE,GAAG,MAAM,GAAG;gBAC3B,QAAQ,IAAI,CAAC,IAAI,GAAG,MAAM,IAAI;YAClC;YACA,OAAO;QACX;QACA,MAAM,KAAI,EAAE,KAAK,EAAE,IAAI,EAAE;YACrB,IAAI,MAAM;gBACN,MAAM,GAAG,GAAG,KAAK,EAAE;gBACnB,IAAI,AAAC,KAAa,IAAI,EAAE,MAAM,IAAI,GAAG,AAAC,KAAa,IAAI;YAC3D;YAEA,IAAI,MAAM,GAAG,IAAI,CAAC,MAAM,IAAI,EAAE;gBAC1B,MAAM,EAAE,IAAI,EAAE,GAAG,MAAM,uIAAa,CAC/B,IAAI,CAAC,SACL,MAAM,CAAC,QACP,EAAE,CAAC,MAAM,MAAM,GAAG,EAClB,MAAM;gBAEX,IAAI,MAAM;oBACN,MAAM,IAAI,GAAG,KAAK,IAAI;gBAC1B;YACJ;YACA,OAAO;QACX;IACJ;IACA,SAAS;QACL,UAAU;IACd;IACA,OAAO;QACH,QAAQ;IACZ;AACJ","debugId":null}},
    {"offset": {"line": 188, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Kadeeja/Desktop/New%20folder/src/proxy.ts"],"sourcesContent":["import { auth } from \"@/auth\"\r\nimport { NextResponse } from \"next/server\"\r\n\r\nexport const proxy = auth((req) => {\r\n    const isLoggedIn = !!req.auth\r\n    const isOnAdmin = req.nextUrl.pathname.startsWith(\"/admin\")\r\n\r\n    if (isOnAdmin) {\r\n        if (!isLoggedIn) return NextResponse.redirect(new URL(\"/login\", req.nextUrl))\r\n        const role = req.auth?.user?.role;\r\n        if (role !== \"ADMIN\" && role !== \"SUPER_ADMIN\") {\r\n            return NextResponse.redirect(new URL(\"/\", req.nextUrl))\r\n        }\r\n    }\r\n\r\n    return NextResponse.next()\r\n})\r\n\r\nexport const config = {\r\n    matcher: [\"/admin/:path*\", \"/account/:path*\"],\r\n}\r\n"],"names":[],"mappings":";;;;;;AAAA;AACA;;;AAEO,MAAM,QAAQ,IAAA,mHAAI,EAAC,CAAC;IACvB,MAAM,aAAa,CAAC,CAAC,IAAI,IAAI;IAC7B,MAAM,YAAY,IAAI,OAAO,CAAC,QAAQ,CAAC,UAAU,CAAC;IAElD,IAAI,WAAW;QACX,IAAI,CAAC,YAAY,OAAO,8IAAY,CAAC,QAAQ,CAAC,IAAI,IAAI,UAAU,IAAI,OAAO;QAC3E,MAAM,OAAO,IAAI,IAAI,EAAE,MAAM;QAC7B,IAAI,SAAS,WAAW,SAAS,eAAe;YAC5C,OAAO,8IAAY,CAAC,QAAQ,CAAC,IAAI,IAAI,KAAK,IAAI,OAAO;QACzD;IACJ;IAEA,OAAO,8IAAY,CAAC,IAAI;AAC5B;AAEO,MAAM,SAAS;IAClB,SAAS;QAAC;QAAiB;KAAkB;AACjD","debugId":null}}]
}