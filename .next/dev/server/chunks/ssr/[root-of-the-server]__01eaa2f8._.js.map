{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 10, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Kadeeja/Desktop/New%20folder/src/lib/supabase.ts"],"sourcesContent":["import { createClient } from '@supabase/supabase-js';\r\n\r\nconst supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL!;\r\nconst supabaseAnonKey = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!;\r\n\r\nexport const supabase = createClient(supabaseUrl, supabaseAnonKey);\r\n\r\n// Server-side client with service role (use carefully!)\r\nexport const supabaseAdmin = createClient(\r\n    supabaseUrl,\r\n    process.env.SUPABASE_SERVICE_ROLE_KEY!,\r\n    {\r\n        auth: {\r\n            autoRefreshToken: false,\r\n            persistSession: false\r\n        }\r\n    }\r\n);\r\n"],"names":[],"mappings":";;;;;;AAAA;;AAEA,MAAM;AACN,MAAM;AAEC,MAAM,WAAW,IAAA,8LAAY,EAAC,aAAa;AAG3C,MAAM,gBAAgB,IAAA,8LAAY,EACrC,aACA,QAAQ,GAAG,CAAC,yBAAyB,EACrC;IACI,MAAM;QACF,kBAAkB;QAClB,gBAAgB;IACpB;AACJ","debugId":null}},
    {"offset": {"line": 31, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Kadeeja/Desktop/New%20folder/src/auth.ts"],"sourcesContent":["import NextAuth from \"next-auth\"\r\nimport { SupabaseAdapter } from \"@auth/supabase-adapter\"\r\nimport Credentials from \"next-auth/providers/credentials\"\r\nimport Google from \"next-auth/providers/google\"\r\nimport { z } from \"zod\"\r\nimport { supabaseAdmin } from \"./lib/supabase\"\r\nimport bcrypt from \"bcryptjs\"\r\n\r\nexport const { handlers, auth, signIn, signOut } = NextAuth({\r\n    adapter: SupabaseAdapter({\r\n        url: process.env.NEXT_PUBLIC_SUPABASE_URL!,\r\n        secret: process.env.SUPABASE_SERVICE_ROLE_KEY!,\r\n    }),\r\n    providers: [\r\n        Google,\r\n        Credentials({\r\n            credentials: {\r\n                email: { label: \"Email\", type: \"email\" },\r\n                password: { label: \"Password\", type: \"password\" },\r\n            },\r\n            authorize: async (credentials) => {\r\n                const parsedCredentials = z\r\n                    .object({ email: z.string().email(), password: z.string().min(6) })\r\n                    .safeParse(credentials)\r\n\r\n                if (parsedCredentials.success) {\r\n                    const { email, password } = parsedCredentials.data\r\n\r\n                    // 1. Fetch user from Supabase\r\n                    const { data: user } = await supabaseAdmin\r\n                        .from('users')\r\n                        .select('*')\r\n                        .eq('email', email)\r\n                        .single()\r\n\r\n                    if (user && user.password) {\r\n                        // 2. Verify password with bcrypt\r\n                        const passwordsMatch = await bcrypt.compare(password, user.password);\r\n\r\n                        if (passwordsMatch) {\r\n                            return {\r\n                                id: user.id,\r\n                                email: user.email,\r\n                                name: user.name,\r\n                                role: user.role,\r\n                                image: user.image,\r\n                            }\r\n                        }\r\n                    }\r\n                    return null;\r\n\r\n                    // 2. Demo Auto-Signup: Create user if not exists\r\n                    const { data: newUser, error: createError } = await supabaseAdmin\r\n                        .from('users')\r\n                        .insert({\r\n                            email,\r\n                            name: email.split(\"@\")[0],\r\n                            image: `https://i.pravatar.cc/150?u=${email}`,\r\n                            role: 'USER'\r\n                        })\r\n                        .select()\r\n                        .single()\r\n\r\n                    if (newUser) {\r\n                        return {\r\n                            id: newUser.id,\r\n                            email: newUser.email,\r\n                            name: newUser.name,\r\n                            role: newUser.role,\r\n                            image: newUser.image,\r\n                        }\r\n                    }\r\n                }\r\n                return null\r\n            },\r\n        }),\r\n    ],\r\n    callbacks: {\r\n        async session({ session, token }) {\r\n            if (token?.sub && session.user) {\r\n                session.user.id = token.sub;\r\n                session.user.role = token.role as \"USER\" | \"ADMIN\" | \"SUPER_ADMIN\";\r\n            }\r\n            return session\r\n        },\r\n        async jwt({ token, user }) {\r\n            if (user) {\r\n                token.sub = user.id;\r\n                if ((user as any).role) token.role = (user as any).role;\r\n            }\r\n\r\n            if (token.sub && !token.role) {\r\n                const { data } = await supabaseAdmin\r\n                    .from('users')\r\n                    .select('role')\r\n                    .eq('id', token.sub)\r\n                    .single();\r\n\r\n                if (data) {\r\n                    token.role = data.role;\r\n                }\r\n            }\r\n            return token\r\n        }\r\n    },\r\n    session: {\r\n        strategy: \"jwt\", // Credentials provider requires JWT strategy usually\r\n    },\r\n    pages: {\r\n        signIn: \"/login\",\r\n    }\r\n})\r\n"],"names":[],"mappings":";;;;;;;;;;AAAA;AACA;AACA;AAAA;AACA;AAAA;AACA;AACA;AACA;;;;;;;;AAEO,MAAM,EAAE,QAAQ,EAAE,IAAI,EAAE,MAAM,EAAE,OAAO,EAAE,GAAG,IAAA,gKAAQ,EAAC;IACxD,SAAS,IAAA,yKAAe,EAAC;QACrB,GAAG;QACH,QAAQ,QAAQ,GAAG,CAAC,yBAAyB;IACjD;IACA,WAAW;QACP,gMAAM;QACN,IAAA,qMAAW,EAAC;YACR,aAAa;gBACT,OAAO;oBAAE,OAAO;oBAAS,MAAM;gBAAQ;gBACvC,UAAU;oBAAE,OAAO;oBAAY,MAAM;gBAAW;YACpD;YACA,WAAW,OAAO;gBACd,MAAM,oBAAoB,uKAAC,CACtB,MAAM,CAAC;oBAAE,OAAO,uKAAC,CAAC,MAAM,GAAG,KAAK;oBAAI,UAAU,uKAAC,CAAC,MAAM,GAAG,GAAG,CAAC;gBAAG,GAChE,SAAS,CAAC;gBAEf,IAAI,kBAAkB,OAAO,EAAE;oBAC3B,MAAM,EAAE,KAAK,EAAE,QAAQ,EAAE,GAAG,kBAAkB,IAAI;oBAElD,8BAA8B;oBAC9B,MAAM,EAAE,MAAM,IAAI,EAAE,GAAG,MAAM,uIAAa,CACrC,IAAI,CAAC,SACL,MAAM,CAAC,KACP,EAAE,CAAC,SAAS,OACZ,MAAM;oBAEX,IAAI,QAAQ,KAAK,QAAQ,EAAE;wBACvB,iCAAiC;wBACjC,MAAM,iBAAiB,MAAM,4IAAM,CAAC,OAAO,CAAC,UAAU,KAAK,QAAQ;wBAEnE,IAAI,gBAAgB;4BAChB,OAAO;gCACH,IAAI,KAAK,EAAE;gCACX,OAAO,KAAK,KAAK;gCACjB,MAAM,KAAK,IAAI;gCACf,MAAM,KAAK,IAAI;gCACf,OAAO,KAAK,KAAK;4BACrB;wBACJ;oBACJ;oBACA,OAAO;;;oBAEP,iDAAiD;oBACjD,MAAc,qBAAgB;gBAoBlC;gBACA,OAAO;YACX;QACJ;KACH;IACD,WAAW;QACP,MAAM,SAAQ,EAAE,OAAO,EAAE,KAAK,EAAE;YAC5B,IAAI,OAAO,OAAO,QAAQ,IAAI,EAAE;gBAC5B,QAAQ,IAAI,CAAC,EAAE,GAAG,MAAM,GAAG;gBAC3B,QAAQ,IAAI,CAAC,IAAI,GAAG,MAAM,IAAI;YAClC;YACA,OAAO;QACX;QACA,MAAM,KAAI,EAAE,KAAK,EAAE,IAAI,EAAE;YACrB,IAAI,MAAM;gBACN,MAAM,GAAG,GAAG,KAAK,EAAE;gBACnB,IAAI,AAAC,KAAa,IAAI,EAAE,MAAM,IAAI,GAAG,AAAC,KAAa,IAAI;YAC3D;YAEA,IAAI,MAAM,GAAG,IAAI,CAAC,MAAM,IAAI,EAAE;gBAC1B,MAAM,EAAE,IAAI,EAAE,GAAG,MAAM,uIAAa,CAC/B,IAAI,CAAC,SACL,MAAM,CAAC,QACP,EAAE,CAAC,MAAM,MAAM,GAAG,EAClB,MAAM;gBAEX,IAAI,MAAM;oBACN,MAAM,IAAI,GAAG,KAAK,IAAI;gBAC1B;YACJ;YACA,OAAO;QACX;IACJ;IACA,SAAS;QACL,UAAU;IACd;IACA,OAAO;QACH,QAAQ;IACZ;AACJ","debugId":null}},
    {"offset": {"line": 140, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Kadeeja/Desktop/New%20folder/src/actions/auth.ts"],"sourcesContent":["'use server';\r\n\r\nimport { signIn, signOut } from \"@/auth\";\r\nimport { supabaseAdmin } from \"@/lib/supabase\";\r\nimport bcrypt from \"bcryptjs\";\r\n\r\nexport async function signupAction(formData: FormData) {\r\n    const email = formData.get(\"email\") as string;\r\n    const password = formData.get(\"password\") as string;\r\n    const name = formData.get(\"name\") as string;\r\n\r\n    if (!email || !password) return { error: \"Missing fields\" };\r\n\r\n    try {\r\n        // 1. Check if user already exists\r\n        const { data: existingUser } = await supabaseAdmin\r\n            .from('users')\r\n            .select('id')\r\n            .eq('email', email)\r\n            .single();\r\n\r\n        if (existingUser) return { error: \"User already exists\" };\r\n\r\n        // 2. Hash password\r\n        const hashedPassword = await bcrypt.hash(password, 10);\r\n\r\n        // 3. Create user\r\n        const { data: newUser, error: createError } = await supabaseAdmin\r\n            .from('users')\r\n            .insert({\r\n                email,\r\n                password: hashedPassword,\r\n                name: name || email.split(\"@\")[0],\r\n                image: `https://i.pravatar.cc/150?u=${email}`,\r\n                role: 'USER'\r\n            })\r\n            .select()\r\n            .single();\r\n\r\n        if (createError) throw createError;\r\n\r\n        // 4. Sign in with the new account\r\n        // We set redirect: false to handle the redirect manually and ensure a clean state\r\n        await signIn(\"credentials\", {\r\n            email,\r\n            password,\r\n            redirect: false\r\n        });\r\n\r\n        return { success: true };\r\n    } catch (error) {\r\n        return { error: \"Failed to create account\" };\r\n    }\r\n}\r\n\r\nexport async function loginAction(formData: FormData) {\r\n    const email = formData.get(\"email\") as string;\r\n    const password = formData.get(\"password\") as string;\r\n\r\n    if (!email || !password) return { error: \"Missing fields\" };\r\n\r\n    try {\r\n        const result = await signIn(\"credentials\", {\r\n            email,\r\n            password,\r\n            redirect: false,\r\n        });\r\n\r\n        if (result?.error) return { error: \"Invalid credentials\" };\r\n\r\n        return { success: true };\r\n    } catch (error) {\r\n        return { error: \"Authentication failed\" };\r\n    }\r\n}\r\n\r\nexport async function socialLoginAction(provider: string) {\r\n    await signIn(provider, { redirectTo: \"/account\" });\r\n}\r\n\r\nexport async function logoutAction() {\r\n    await signOut({ redirectTo: \"/\" });\r\n}\r\n"],"names":[],"mappings":";;;;;;;;;;;AAEA;AACA;AACA;;;;;;AAEO,eAAe,aAAa,QAAkB;IACjD,MAAM,QAAQ,SAAS,GAAG,CAAC;IAC3B,MAAM,WAAW,SAAS,GAAG,CAAC;IAC9B,MAAM,OAAO,SAAS,GAAG,CAAC;IAE1B,IAAI,CAAC,SAAS,CAAC,UAAU,OAAO;QAAE,OAAO;IAAiB;IAE1D,IAAI;QACA,kCAAkC;QAClC,MAAM,EAAE,MAAM,YAAY,EAAE,GAAG,MAAM,uIAAa,CAC7C,IAAI,CAAC,SACL,MAAM,CAAC,MACP,EAAE,CAAC,SAAS,OACZ,MAAM;QAEX,IAAI,cAAc,OAAO;YAAE,OAAO;QAAsB;QAExD,mBAAmB;QACnB,MAAM,iBAAiB,MAAM,4IAAM,CAAC,IAAI,CAAC,UAAU;QAEnD,iBAAiB;QACjB,MAAM,EAAE,MAAM,OAAO,EAAE,OAAO,WAAW,EAAE,GAAG,MAAM,uIAAa,CAC5D,IAAI,CAAC,SACL,MAAM,CAAC;YACJ;YACA,UAAU;YACV,MAAM,QAAQ,MAAM,KAAK,CAAC,IAAI,CAAC,EAAE;YACjC,OAAO,CAAC,4BAA4B,EAAE,OAAO;YAC7C,MAAM;QACV,GACC,MAAM,GACN,MAAM;QAEX,IAAI,aAAa,MAAM;QAEvB,kCAAkC;QAClC,kFAAkF;QAClF,MAAM,IAAA,qHAAM,EAAC,eAAe;YACxB;YACA;YACA,UAAU;QACd;QAEA,OAAO;YAAE,SAAS;QAAK;IAC3B,EAAE,OAAO,OAAO;QACZ,OAAO;YAAE,OAAO;QAA2B;IAC/C;AACJ;AAEO,eAAe,YAAY,QAAkB;IAChD,MAAM,QAAQ,SAAS,GAAG,CAAC;IAC3B,MAAM,WAAW,SAAS,GAAG,CAAC;IAE9B,IAAI,CAAC,SAAS,CAAC,UAAU,OAAO;QAAE,OAAO;IAAiB;IAE1D,IAAI;QACA,MAAM,SAAS,MAAM,IAAA,qHAAM,EAAC,eAAe;YACvC;YACA;YACA,UAAU;QACd;QAEA,IAAI,QAAQ,OAAO,OAAO;YAAE,OAAO;QAAsB;QAEzD,OAAO;YAAE,SAAS;QAAK;IAC3B,EAAE,OAAO,OAAO;QACZ,OAAO;YAAE,OAAO;QAAwB;IAC5C;AACJ;AAEO,eAAe,kBAAkB,QAAgB;IACpD,MAAM,IAAA,qHAAM,EAAC,UAAU;QAAE,YAAY;IAAW;AACpD;AAEO,eAAe;IAClB,MAAM,IAAA,sHAAO,EAAC;QAAE,YAAY;IAAI;AACpC;;;IA5EsB;IAiDA;IAqBA;IAIA;;AA1EA,+OAAA;AAiDA,+OAAA;AAqBA,+OAAA;AAIA,+OAAA","debugId":null}},
    {"offset": {"line": 248, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Kadeeja/Desktop/New%20folder/.next-internal/server/app/login/page/actions.js%20%28server%20actions%20loader%29"],"sourcesContent":["export {loginAction as '40328e01c8a2b2b4333aaea3809124912dfcdc0dc3'} from 'ACTIONS_MODULE0'\nexport {signupAction as '40243378c01c255fa8fae27226533bd44505b7719c'} from 'ACTIONS_MODULE0'\nexport {socialLoginAction as '403e243cd7f6c593f9c9232615f134b1521acce979'} from 'ACTIONS_MODULE0'\n"],"names":[],"mappings":";AAAA","debugId":null}}]
}